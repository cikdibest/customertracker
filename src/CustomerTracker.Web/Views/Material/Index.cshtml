@model IPagedList<CustomerTracker.Web.Business.SearchBusiness.SearchResultModel>

@{
    ViewBag.Title = "title"; 
}
<style>
    .sel {
        background-color: #3982C1;
    }
</style>

<script src="~/Scripts/domain/material/materialFactory.js"></script>
<script src="~/Scripts/domain/material/materialController.js"></script>

<div id="divMain" ng-controller="materialController">

    <div class="row">
        <div class="col-lg-4">
            <div class="row">
                <div class="col-lg-4 pull-right">
                    <div class="btn-group">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                            <span>{{activeSearchType.Value}}</span>
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            @foreach (KeyValuePair<int, string> item in ViewBag.SearchTypes)
                            {
                                <li><a href="#" ng-click="setActiveSearchType(@item.Key,'@item.Value')">@item.Value</a></li>    
                            }


                        </ul>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="col-lg-11">
                        <input class="form-control" style="width: 100%" ng-model="searchCriteria" required id="searchInput" />
                    </div>
                    <div class="col-lg-1">
                        <button class="btn btn-default" ng-click="searchMaterials()" ng-disabled="!searchCriteria.length">
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                    </div>
                </div>
            </div>
            <hr />
            <div class="row col-lg-10">
                <div class="list-group" ng-repeat="material in foundMaterials" ng-if="material.SearchTypeId=='1'">
                    <a href="#" ng-click="loadCustomer(material,$index)" class="list-group-item" ng-class="{sel: $index == selectedMaterialIndex}">
                        <h4 class="list-group-item-heading">{{material.Title}}</h4>
                        <p class="list-group-item-text">{{material.Summary}}</p>
                    </a>
                </div>
                <div class="list-group" ng-repeat="material in foundMaterials" ng-if="material.SearchTypeId=='2'" ng-class="{sel: $index == selectedMaterialIndex}">
                    <span class="name">{{material.Title}}</span><br />
                    <table class="table table-condensed table-responsive table-user-information">
                        <tbody>
                            <tr>
                                <td>Görev</td>
                                <td>{{material.Summary}}</td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <a href="#" ng-click="loadCustomer(material,$index)">Müşteri'ye git</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
        <div class="col-lg-7" data-ng-show="selectedCustomer!=null">
            @{Html.RenderPartial("_CustomerDetail");}
        </div>
    </div>
</div>



<script>

    $("#searchInput").focus();
    
    $(document).keypress(function (e) {

        if (e.which == 13) {
            var scope = angular.element(document.getElementById("divMain")).scope();

            scope.searchMaterials();
        }
    });

</script>
